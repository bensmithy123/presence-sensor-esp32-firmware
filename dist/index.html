<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Presence Sensor ESP32 Firmware Flasher</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif;
      }
      body {
        margin: 0;
        background: #0b1020;
        color: #f5f7ff;
      }
      main {
        max-width: 900px;
        margin: 0 auto;
        padding: 64px 24px 80px;
      }
      .card {
        background: #121a35;
        border: 1px solid #223060;
        border-radius: 20px;
        padding: 32px;
        box-shadow: 0 20px 60px rgba(4, 10, 25, 0.35);
      }
      h1 {
        font-size: clamp(2rem, 3vw, 2.75rem);
        margin: 0 0 12px;
      }
      p {
        margin: 0 0 16px;
        line-height: 1.6;
        color: #c9d1ff;
      }
      ol {
        margin: 0 0 24px 20px;
        padding: 0;
        color: #c9d1ff;
      }
      li {
        margin-bottom: 10px;
      }
      .note {
        background: rgba(79, 109, 255, 0.15);
        border: 1px solid rgba(79, 109, 255, 0.4);
        border-radius: 12px;
        padding: 12px 16px;
        margin-bottom: 24px;
        color: #d8e1ff;
      }
      .actions {
        display: flex;
        flex-direction: column;
        gap: 20px;
        align-items: flex-start;
      }
      .action-card {
        width: 100%;
        padding: 16px;
        border: 1px solid rgba(141, 212, 255, 0.35);
        border-radius: 16px;
        background: rgba(8, 14, 32, 0.35);
      }
      .action-card h2 {
        margin: 0 0 8px;
        font-size: 1.2rem;
      }
      .action-card p {
        margin-bottom: 12px;
      }
      esp-web-install-button {
        --esp-tools-button-color: #0b1020;
        --esp-tools-button-text-color: #c9d1ff;
        --esp-tools-button-border-radius: 12px;
        --esp-tools-button-background: #8dd4ff;
        --esp-tools-button-hover-background: #70c6ff;
        --esp-tools-button-shadow: 0 10px 25px rgba(110, 198, 255, 0.35);
      }
      .footer {
        margin-top: 32px;
        font-size: 0.9rem;
        color: #97a3d8;
      }
      a {
        color: inherit;
      }
      @media (prefers-color-scheme: light) {
        body {
          background: #eef2ff;
          color: #101625;
        }
        .card {
          background: #ffffff;
          border-color: #d8def5;
        }
        p,
        ol,
        .note,
        .footer {
          color: #39446d;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <div class="card">
        <h1>Presence Sensor Firmware Flasher</h1>
        <p>
          Flash the latest firmware directly from your browser. This uses the
          Web Serial API, so it works in Chromium-based browsers (Chrome, Edge,
          Brave) on desktop.
        </p>
        <div class="note">
          You will be asked to select the ESP32 serial port during the flash
          process.
        </div>
        <ol>
          <li>Connect the Presence Sensor board via USB.</li>
          <li>Choose the install mode below and follow the prompts.</li>
          <li>Wait for the flash to complete before disconnecting.</li>
        </ol>
        <div class="actions">
          <div class="action-card">
            <h2>Wipe &amp; Install (factory)</h2>
            <p>
              Best for a fresh install or when you want to reset everything.
              This will erase the device during setup and flash the full factory
              image.
            </p>
            <esp-web-install-button manifest="./manifest-wipe.json"></esp-web-install-button>
          </div>
          <div class="action-card">
            <h2>Update (keep Wi-Fi)</h2>
            <p>
              Updates only the application partitions, leaving NVS intact so
              Wi-Fi credentials and provisioning stay in place. No erase prompt
              is required.
            </p>
            <esp-web-install-button manifest="./manifest-keep.json"></esp-web-install-button>
          </div>
        </div>
        <p class="footer">
          Having trouble? Make sure no other apps are using the serial port and
          try a different USB cable if the device does not appear.
        </p>
      </div>
    </main>
    <script
      type="module"
      src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"
    ></script>
  </body>
</html>
